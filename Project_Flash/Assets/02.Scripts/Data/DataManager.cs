using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;
using System.IO;
using DataInfo;

public class DataManager
{
    string GameDataFileName = "GameData.json";

    public GameData data = new GameData(); // 스크립트 내에 data 저장 공간 생성

    public void LoadGameData() // 로컬 파일 경로에 저장된 데이터를 불러옴
    {
        string filePath = Application.persistentDataPath + "/" + GameDataFileName;
        if (File.Exists(filePath) == true) // 저장된 데이터가 있다면, 데이터를 로드하고, 해당 정보를 data에 적용함
        {
            string FromJsonData = File.ReadAllText(filePath);

            data = JsonUtility.FromJson<GameData>(FromJsonData);
        }
    }

    public void SaveGameData() // data형태로 존재하는 저장 필요 데이터를, 로컬 파일로 저장함
    {
        string ToJsonData = JsonUtility.ToJson(data, true); // 데이터 보기 좋게 정리
        string filePath = Application.persistentDataPath + "/" + GameDataFileName;

        File.WriteAllText(filePath, ToJsonData); // 파일이 존재한다면 덮어 씌우기, 존재하지 않는다면 새로 만들기
    }

    public void SetSavePos(Vector3 savePoint) // 데이터 로컬 파일 저장과는 별개로, savepoint의 위치정보를 data에 저장함
    {
        data._savePos = savePoint.x + "," + savePoint.y + "," + savePoint.z;
    }

    public Vector3 GetSavePos() // 저장된 로컬 파일과는 별개로, savepoint의 위치정보를 불러옴
    {
        string[] savePosArray = data._savePos.Split(',');
        Vector3 pos = new Vector3(float.Parse(savePosArray[0]), float.Parse(savePosArray[1]), float.Parse(savePosArray[2]));

        return pos;
    }

    // 이하 get/set문은 위 savePos 구문과 같은 구조를 가짐
    public void SetVelocity(Vector3 velocity)
    {
        data._velocity = velocity.x + "," + velocity.y + "," + velocity.z;
    }
    public Vector3 GetVelocity()
    {
        string[] velocityArray = data._velocity.Split(',');
        Vector3 velocity = new Vector3(float.Parse(velocityArray[0]), float.Parse(velocityArray[1]), float.Parse(velocityArray[2]));

        return velocity;
    }
    public void SetGravityScale(float gravityScale)
    {
        data._gravityScale = gravityScale;
    }
    public float GetGravityScale()
    {
        return data._gravityScale;
    }
    public void SetLinearDrag(float linearDrag)
    {
        data._linearDrag = linearDrag;
    }
    public float GetLinearDrag()
    {
        return data._linearDrag;
    }
    public void SetIsFallen(bool isFallen)
    {
        data._isFallen = isFallen;
    }
    public bool GetIsFallen()
    {
        return data._isFallen;
    }
    public void SetIsMove(bool isMove)
    {
        data._isMove = isMove;
    }
    public bool GetIsMove()
    {
        return data._isMove;
    }
    public void SetDuration(float duration)
    {
        data._duration = duration;
    }
    public float GetDuration()
    {
        return data._duration;
    }
    public void SetIsignoreLayerCollision(bool isignoreLayerCollision)
    {
        data._isignoreLayerCollision = isignoreLayerCollision;
    }
    public bool GetIsignoreLayerCollision()
    {
        return data._isignoreLayerCollision;
    }
    public void SetIsFirstPlay(bool isFirstPlay) // 뉴게임 버튼 눌렀을 때, false를 저장하도록 하고, 게임 클리어 했을 때, true를 저장하도록 함
    {
        data._isFirstPlay = isFirstPlay;
    }
    public bool GetIsFirstPlay()
    {
        return data._isFirstPlay;
    }
    public void SetLevel(int level)
    {
        data._level = level;
    }
    public int GetLevel()
    {
        return data._level;
    }
    public void ResetSaveData() // 저장된 모든 정보를 초기화 함
    {
        data = new GameData();
    }
}
